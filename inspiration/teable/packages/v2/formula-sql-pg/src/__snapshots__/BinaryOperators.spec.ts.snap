// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`binary comparison operators > 'Eq' 'attachment' '=' 'attachment' 1`] = `
{
  "formula": "{Attachment} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'attachment' '=' 'date' 1`] = `
{
  "formula": "{Attachment} = {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'attachment' '=' 'link' 1`] = `
{
  "formula": "{Attachment} = {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'attachment' '=' 'user' 1`] = `
{
  "formula": "{Attachment} = {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'autoNumber' '=' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} = {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') = COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'button' '=' 'button' 1`] = `
{
  "formula": "{Button} = {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') = COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'checkbox' '=' 'attachment' 1`] = `
{
  "formula": "{Checkbox} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'checkbox' '=' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') = COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'checkbox' '=' 'date' 1`] = `
{
  "formula": "{Checkbox} = {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'checkbox' '=' 'link' 1`] = `
{
  "formula": "{Checkbox} = {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'checkbox' '=' 'user' 1`] = `
{
  "formula": "{Checkbox} = {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'conditionalLookup' '=' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} = {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') = COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'conditionalRollup' '=' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} = {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') = COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'createdBy' '=' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} = {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') = COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'createdTime' '=' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} = {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') = COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'date' '=' 'date' 1`] = `
{
  "formula": "{Date} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'date' '=' 'link' 1`] = `
{
  "formula": "{Date} = {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'date' '=' 'user' 1`] = `
{
  "formula": "{Date} = {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'attachment' 1`] = `
{
  "formula": "{FormulaType} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "((10)::double precision = (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'date' 1`] = `
{
  "formula": "{FormulaType} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'formula' 1`] = `
{
  "formula": "{FormulaType} = {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'link' 1`] = `
{
  "formula": "{FormulaType} = {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} = {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} = {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'formula' '=' 'user' 1`] = `
{
  "formula": "{FormulaType} = {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'lastModifiedBy' '=' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} = {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') = COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'lastModifiedTime' '=' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} = {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') = COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'link' '=' 'link' 1`] = `
{
  "formula": "{LinkType} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'longText' '=' 'longText' 1`] = `
{
  "formula": "{LongText} = {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') = COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'lookup' '=' 'lookup' 1`] = `
{
  "formula": "{LookupType} = {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') = COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'date' 1`] = `
{
  "formula": "{MultipleSelect} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'link' 1`] = `
{
  "formula": "{MultipleSelect} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} = {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'multipleSelect' '=' 'user' 1`] = `
{
  "formula": "{MultipleSelect} = {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'attachment' 1`] = `
{
  "formula": "{Number} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'autoNumber' 1`] = `
{
  "formula": "{Number} = {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'checkbox' 1`] = `
{
  "formula": "{Number} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision = (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'date' 1`] = `
{
  "formula": "{Number} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'formula' 1`] = `
{
  "formula": "{Number} = {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'link' 1`] = `
{
  "formula": "{Number} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'longText' 1`] = `
{
  "formula": "{Number} = {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'multipleSelect' 1`] = `
{
  "formula": "{Number} = {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'number' 1`] = `
{
  "formula": "{Number} = {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'rating' 1`] = `
{
  "formula": "{Number} = {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'singleLineText' 1`] = `
{
  "formula": "{Number} = {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'singleSelect' 1`] = `
{
  "formula": "{Number} = {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'number' '=' 'user' 1`] = `
{
  "formula": "{Number} = {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'rating' '=' 'rating' 1`] = `
{
  "formula": "{Rating} = {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') = COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'rollup' '=' 'rollup' 1`] = `
{
  "formula": "{RollupType} = {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') = COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'date' 1`] = `
{
  "formula": "{SingleLineText} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'formula' 1`] = `
{
  "formula": "{SingleLineText} = {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') = COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'link' 1`] = `
{
  "formula": "{SingleLineText} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} = {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'number' 1`] = `
{
  "formula": "{SingleLineText} = {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) = COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') = COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} = {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} = {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleLineText' '=' 'user' 1`] = `
{
  "formula": "{SingleLineText} = {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} = {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} = {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'date' 1`] = `
{
  "formula": "{SingleSelect} = {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) = (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') = COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'link' 1`] = `
{
  "formula": "{SingleSelect} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} = {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} = {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'singleSelect' '=' 'user' 1`] = `
{
  "formula": "{SingleSelect} = {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'user' '=' 'link' 1`] = `
{
  "formula": "{User} = {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Eq",
  "operator": "=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Eq' 'user' '=' 'user' 1`] = `
{
  "formula": "{User} = {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Eq",
  "operator": "=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') = COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'attachment' '>' 'attachment' 1`] = `
{
  "formula": "{Attachment} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'attachment' '>' 'date' 1`] = `
{
  "formula": "{Attachment} > {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'attachment' '>' 'link' 1`] = `
{
  "formula": "{Attachment} > {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'attachment' '>' 'user' 1`] = `
{
  "formula": "{Attachment} > {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'autoNumber' '>' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} > {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') > COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'button' '>' 'button' 1`] = `
{
  "formula": "{Button} > {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') > COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'checkbox' '>' 'attachment' 1`] = `
{
  "formula": "{Checkbox} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'checkbox' '>' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') > COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'checkbox' '>' 'date' 1`] = `
{
  "formula": "{Checkbox} > {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'checkbox' '>' 'link' 1`] = `
{
  "formula": "{Checkbox} > {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'checkbox' '>' 'user' 1`] = `
{
  "formula": "{Checkbox} > {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'conditionalLookup' '>' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} > {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') > COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'conditionalRollup' '>' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} > {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') > COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'createdBy' '>' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} > {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') > COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'createdTime' '>' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} > {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') > COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'date' '>' 'date' 1`] = `
{
  "formula": "{Date} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'date' '>' 'link' 1`] = `
{
  "formula": "{Date} > {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'date' '>' 'user' 1`] = `
{
  "formula": "{Date} > {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'attachment' 1`] = `
{
  "formula": "{FormulaType} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "checkbox",
  "sql": "((10)::double precision > (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'date' 1`] = `
{
  "formula": "{FormulaType} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'formula' 1`] = `
{
  "formula": "{FormulaType} > {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'link' 1`] = `
{
  "formula": "{FormulaType} > {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} > {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} > {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'formula' '>' 'user' 1`] = `
{
  "formula": "{FormulaType} > {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'lastModifiedBy' '>' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} > {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') > COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'lastModifiedTime' '>' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} > {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') > COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'link' '>' 'link' 1`] = `
{
  "formula": "{LinkType} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'longText' '>' 'longText' 1`] = `
{
  "formula": "{LongText} > {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') > COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'lookup' '>' 'lookup' 1`] = `
{
  "formula": "{LookupType} > {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') > COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'date' 1`] = `
{
  "formula": "{MultipleSelect} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'link' 1`] = `
{
  "formula": "{MultipleSelect} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} > {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'multipleSelect' '>' 'user' 1`] = `
{
  "formula": "{MultipleSelect} > {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'attachment' 1`] = `
{
  "formula": "{Number} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'autoNumber' 1`] = `
{
  "formula": "{Number} > {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'checkbox' 1`] = `
{
  "formula": "{Number} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision > (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'date' 1`] = `
{
  "formula": "{Number} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'formula' 1`] = `
{
  "formula": "{Number} > {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'link' 1`] = `
{
  "formula": "{Number} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'longText' 1`] = `
{
  "formula": "{Number} > {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'multipleSelect' 1`] = `
{
  "formula": "{Number} > {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'number' 1`] = `
{
  "formula": "{Number} > {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'rating' 1`] = `
{
  "formula": "{Number} > {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'singleLineText' 1`] = `
{
  "formula": "{Number} > {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'singleSelect' 1`] = `
{
  "formula": "{Number} > {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'number' '>' 'user' 1`] = `
{
  "formula": "{Number} > {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'rating' '>' 'rating' 1`] = `
{
  "formula": "{Rating} > {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') > COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'rollup' '>' 'rollup' 1`] = `
{
  "formula": "{RollupType} > {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') > COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'date' 1`] = `
{
  "formula": "{SingleLineText} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'formula' 1`] = `
{
  "formula": "{SingleLineText} > {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') > COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'link' 1`] = `
{
  "formula": "{SingleLineText} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} > {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'number' 1`] = `
{
  "formula": "{SingleLineText} > {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) > COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') > COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} > {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} > {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleLineText' '>' 'user' 1`] = `
{
  "formula": "{SingleLineText} > {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} > {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} > {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'date' 1`] = `
{
  "formula": "{SingleSelect} > {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) > (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') > COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'link' 1`] = `
{
  "formula": "{SingleSelect} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} > {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} > {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'singleSelect' '>' 'user' 1`] = `
{
  "formula": "{SingleSelect} > {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Gt",
  "operator": ">",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'user' '>' 'link' 1`] = `
{
  "formula": "{User} > {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gt' 'user' '>' 'user' 1`] = `
{
  "formula": "{User} > {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Gt",
  "operator": ">",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') > COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'attachment' '>=' 'attachment' 1`] = `
{
  "formula": "{Attachment} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'attachment' '>=' 'date' 1`] = `
{
  "formula": "{Attachment} >= {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'attachment' '>=' 'link' 1`] = `
{
  "formula": "{Attachment} >= {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'attachment' '>=' 'user' 1`] = `
{
  "formula": "{Attachment} >= {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'autoNumber' '>=' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} >= {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') >= COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'button' '>=' 'button' 1`] = `
{
  "formula": "{Button} >= {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') >= COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'checkbox' '>=' 'attachment' 1`] = `
{
  "formula": "{Checkbox} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'checkbox' '>=' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') >= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'checkbox' '>=' 'date' 1`] = `
{
  "formula": "{Checkbox} >= {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'checkbox' '>=' 'link' 1`] = `
{
  "formula": "{Checkbox} >= {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'checkbox' '>=' 'user' 1`] = `
{
  "formula": "{Checkbox} >= {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'conditionalLookup' '>=' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} >= {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') >= COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'conditionalRollup' '>=' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} >= {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') >= COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'createdBy' '>=' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} >= {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') >= COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'createdTime' '>=' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} >= {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') >= COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'date' '>=' 'date' 1`] = `
{
  "formula": "{Date} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'date' '>=' 'link' 1`] = `
{
  "formula": "{Date} >= {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'date' '>=' 'user' 1`] = `
{
  "formula": "{Date} >= {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'attachment' 1`] = `
{
  "formula": "{FormulaType} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "((10)::double precision >= (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'date' 1`] = `
{
  "formula": "{FormulaType} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'formula' 1`] = `
{
  "formula": "{FormulaType} >= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'link' 1`] = `
{
  "formula": "{FormulaType} >= {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} >= {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} >= {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'formula' '>=' 'user' 1`] = `
{
  "formula": "{FormulaType} >= {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'lastModifiedBy' '>=' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} >= {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') >= COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'lastModifiedTime' '>=' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} >= {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') >= COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'link' '>=' 'link' 1`] = `
{
  "formula": "{LinkType} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'longText' '>=' 'longText' 1`] = `
{
  "formula": "{LongText} >= {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') >= COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'lookup' '>=' 'lookup' 1`] = `
{
  "formula": "{LookupType} >= {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') >= COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'date' 1`] = `
{
  "formula": "{MultipleSelect} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'link' 1`] = `
{
  "formula": "{MultipleSelect} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} >= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'multipleSelect' '>=' 'user' 1`] = `
{
  "formula": "{MultipleSelect} >= {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'attachment' 1`] = `
{
  "formula": "{Number} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'autoNumber' 1`] = `
{
  "formula": "{Number} >= {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'checkbox' 1`] = `
{
  "formula": "{Number} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision >= (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'date' 1`] = `
{
  "formula": "{Number} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'formula' 1`] = `
{
  "formula": "{Number} >= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'link' 1`] = `
{
  "formula": "{Number} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'longText' 1`] = `
{
  "formula": "{Number} >= {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'multipleSelect' 1`] = `
{
  "formula": "{Number} >= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'number' 1`] = `
{
  "formula": "{Number} >= {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'rating' 1`] = `
{
  "formula": "{Number} >= {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'singleLineText' 1`] = `
{
  "formula": "{Number} >= {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'singleSelect' 1`] = `
{
  "formula": "{Number} >= {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'number' '>=' 'user' 1`] = `
{
  "formula": "{Number} >= {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'rating' '>=' 'rating' 1`] = `
{
  "formula": "{Rating} >= {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') >= COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'rollup' '>=' 'rollup' 1`] = `
{
  "formula": "{RollupType} >= {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') >= COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'date' 1`] = `
{
  "formula": "{SingleLineText} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'formula' 1`] = `
{
  "formula": "{SingleLineText} >= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') >= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'link' 1`] = `
{
  "formula": "{SingleLineText} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} >= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'number' 1`] = `
{
  "formula": "{SingleLineText} >= {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) >= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') >= COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} >= {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} >= {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleLineText' '>=' 'user' 1`] = `
{
  "formula": "{SingleLineText} >= {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} >= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} >= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'date' 1`] = `
{
  "formula": "{SingleSelect} >= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) >= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') >= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'link' 1`] = `
{
  "formula": "{SingleSelect} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} >= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} >= {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'singleSelect' '>=' 'user' 1`] = `
{
  "formula": "{SingleSelect} >= {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'user' '>=' 'link' 1`] = `
{
  "formula": "{User} >= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Gte",
  "operator": ">=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Gte' 'user' '>=' 'user' 1`] = `
{
  "formula": "{User} >= {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Gte",
  "operator": ">=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') >= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'attachment' '<' 'attachment' 1`] = `
{
  "formula": "{Attachment} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'attachment' '<' 'date' 1`] = `
{
  "formula": "{Attachment} < {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'attachment' '<' 'link' 1`] = `
{
  "formula": "{Attachment} < {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'attachment' '<' 'user' 1`] = `
{
  "formula": "{Attachment} < {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'autoNumber' '<' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} < {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') < COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'button' '<' 'button' 1`] = `
{
  "formula": "{Button} < {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') < COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'checkbox' '<' 'attachment' 1`] = `
{
  "formula": "{Checkbox} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'checkbox' '<' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') < COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'checkbox' '<' 'date' 1`] = `
{
  "formula": "{Checkbox} < {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'checkbox' '<' 'link' 1`] = `
{
  "formula": "{Checkbox} < {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'checkbox' '<' 'user' 1`] = `
{
  "formula": "{Checkbox} < {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'conditionalLookup' '<' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} < {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') < COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'conditionalRollup' '<' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} < {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') < COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'createdBy' '<' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} < {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') < COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'createdTime' '<' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} < {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') < COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'date' '<' 'date' 1`] = `
{
  "formula": "{Date} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'date' '<' 'link' 1`] = `
{
  "formula": "{Date} < {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'date' '<' 'user' 1`] = `
{
  "formula": "{Date} < {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'attachment' 1`] = `
{
  "formula": "{FormulaType} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "checkbox",
  "sql": "((10)::double precision < (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'date' 1`] = `
{
  "formula": "{FormulaType} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'formula' 1`] = `
{
  "formula": "{FormulaType} < {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'link' 1`] = `
{
  "formula": "{FormulaType} < {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} < {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} < {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'formula' '<' 'user' 1`] = `
{
  "formula": "{FormulaType} < {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'lastModifiedBy' '<' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} < {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') < COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'lastModifiedTime' '<' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} < {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') < COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'link' '<' 'link' 1`] = `
{
  "formula": "{LinkType} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'longText' '<' 'longText' 1`] = `
{
  "formula": "{LongText} < {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') < COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'lookup' '<' 'lookup' 1`] = `
{
  "formula": "{LookupType} < {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') < COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'date' 1`] = `
{
  "formula": "{MultipleSelect} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'link' 1`] = `
{
  "formula": "{MultipleSelect} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} < {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'multipleSelect' '<' 'user' 1`] = `
{
  "formula": "{MultipleSelect} < {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'attachment' 1`] = `
{
  "formula": "{Number} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'autoNumber' 1`] = `
{
  "formula": "{Number} < {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'checkbox' 1`] = `
{
  "formula": "{Number} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision < (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'date' 1`] = `
{
  "formula": "{Number} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'formula' 1`] = `
{
  "formula": "{Number} < {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'link' 1`] = `
{
  "formula": "{Number} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'longText' 1`] = `
{
  "formula": "{Number} < {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'multipleSelect' 1`] = `
{
  "formula": "{Number} < {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'number' 1`] = `
{
  "formula": "{Number} < {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'rating' 1`] = `
{
  "formula": "{Number} < {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'singleLineText' 1`] = `
{
  "formula": "{Number} < {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'singleSelect' 1`] = `
{
  "formula": "{Number} < {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'number' '<' 'user' 1`] = `
{
  "formula": "{Number} < {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'rating' '<' 'rating' 1`] = `
{
  "formula": "{Rating} < {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') < COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'rollup' '<' 'rollup' 1`] = `
{
  "formula": "{RollupType} < {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') < COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'date' 1`] = `
{
  "formula": "{SingleLineText} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'formula' 1`] = `
{
  "formula": "{SingleLineText} < {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') < COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'link' 1`] = `
{
  "formula": "{SingleLineText} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} < {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'number' 1`] = `
{
  "formula": "{SingleLineText} < {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) < COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') < COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} < {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} < {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleLineText' '<' 'user' 1`] = `
{
  "formula": "{SingleLineText} < {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} < {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} < {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'date' 1`] = `
{
  "formula": "{SingleSelect} < {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) < (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') < COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'link' 1`] = `
{
  "formula": "{SingleSelect} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} < {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} < {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'singleSelect' '<' 'user' 1`] = `
{
  "formula": "{SingleSelect} < {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'user' '<' 'link' 1`] = `
{
  "formula": "{User} < {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Lt",
  "operator": "<",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lt' 'user' '<' 'user' 1`] = `
{
  "formula": "{User} < {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Lt",
  "operator": "<",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') < COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'attachment' '<=' 'attachment' 1`] = `
{
  "formula": "{Attachment} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'attachment' '<=' 'date' 1`] = `
{
  "formula": "{Attachment} <= {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'attachment' '<=' 'link' 1`] = `
{
  "formula": "{Attachment} <= {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'attachment' '<=' 'user' 1`] = `
{
  "formula": "{Attachment} <= {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'autoNumber' '<=' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} <= {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') <= COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'button' '<=' 'button' 1`] = `
{
  "formula": "{Button} <= {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') <= COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'checkbox' '<=' 'attachment' 1`] = `
{
  "formula": "{Checkbox} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'checkbox' '<=' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'checkbox' '<=' 'date' 1`] = `
{
  "formula": "{Checkbox} <= {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'checkbox' '<=' 'link' 1`] = `
{
  "formula": "{Checkbox} <= {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'checkbox' '<=' 'user' 1`] = `
{
  "formula": "{Checkbox} <= {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'conditionalLookup' '<=' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} <= {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') <= COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'conditionalRollup' '<=' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} <= {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') <= COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'createdBy' '<=' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} <= {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') <= COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'createdTime' '<=' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} <= {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <= COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'date' '<=' 'date' 1`] = `
{
  "formula": "{Date} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'date' '<=' 'link' 1`] = `
{
  "formula": "{Date} <= {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'date' '<=' 'user' 1`] = `
{
  "formula": "{Date} <= {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'attachment' 1`] = `
{
  "formula": "{FormulaType} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "((10)::double precision <= (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'date' 1`] = `
{
  "formula": "{FormulaType} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'formula' 1`] = `
{
  "formula": "{FormulaType} <= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'link' 1`] = `
{
  "formula": "{FormulaType} <= {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} <= {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} <= {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'formula' '<=' 'user' 1`] = `
{
  "formula": "{FormulaType} <= {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'lastModifiedBy' '<=' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} <= {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') <= COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'lastModifiedTime' '<=' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} <= {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <= COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'link' '<=' 'link' 1`] = `
{
  "formula": "{LinkType} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'longText' '<=' 'longText' 1`] = `
{
  "formula": "{LongText} <= {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') <= COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'lookup' '<=' 'lookup' 1`] = `
{
  "formula": "{LookupType} <= {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') <= COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'date' 1`] = `
{
  "formula": "{MultipleSelect} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'link' 1`] = `
{
  "formula": "{MultipleSelect} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} <= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'multipleSelect' '<=' 'user' 1`] = `
{
  "formula": "{MultipleSelect} <= {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'attachment' 1`] = `
{
  "formula": "{Number} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'autoNumber' 1`] = `
{
  "formula": "{Number} <= {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'checkbox' 1`] = `
{
  "formula": "{Number} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision <= (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'date' 1`] = `
{
  "formula": "{Number} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'formula' 1`] = `
{
  "formula": "{Number} <= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'link' 1`] = `
{
  "formula": "{Number} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'longText' 1`] = `
{
  "formula": "{Number} <= {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'multipleSelect' 1`] = `
{
  "formula": "{Number} <= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'number' 1`] = `
{
  "formula": "{Number} <= {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'rating' 1`] = `
{
  "formula": "{Number} <= {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'singleLineText' 1`] = `
{
  "formula": "{Number} <= {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'singleSelect' 1`] = `
{
  "formula": "{Number} <= {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'number' '<=' 'user' 1`] = `
{
  "formula": "{Number} <= {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'rating' '<=' 'rating' 1`] = `
{
  "formula": "{Rating} <= {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') <= COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'rollup' '<=' 'rollup' 1`] = `
{
  "formula": "{RollupType} <= {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') <= COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'date' 1`] = `
{
  "formula": "{SingleLineText} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'formula' 1`] = `
{
  "formula": "{SingleLineText} <= {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') <= COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'link' 1`] = `
{
  "formula": "{SingleLineText} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} <= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'number' 1`] = `
{
  "formula": "{SingleLineText} <= {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) <= COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') <= COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} <= {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} <= {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleLineText' '<=' 'user' 1`] = `
{
  "formula": "{SingleLineText} <= {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} <= {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} <= {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'date' 1`] = `
{
  "formula": "{SingleSelect} <= {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) <= (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') <= COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'link' 1`] = `
{
  "formula": "{SingleSelect} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} <= {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} <= {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'singleSelect' '<=' 'user' 1`] = `
{
  "formula": "{SingleSelect} <= {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Lte",
  "operator": "<=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'user' '<=' 'link' 1`] = `
{
  "formula": "{User} <= {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Lte' 'user' '<=' 'user' 1`] = `
{
  "formula": "{User} <= {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Lte",
  "operator": "<=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <= COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'attachment' '!=' 'attachment' 1`] = `
{
  "formula": "{Attachment} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "leftType": "attachment",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'attachment' '!=' 'date' 1`] = `
{
  "formula": "{Attachment} != {Date}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "attachment",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'attachment' '!=' 'link' 1`] = `
{
  "formula": "{Attachment} != {LinkType}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "attachment",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'attachment' '!=' 'user' 1`] = `
{
  "formula": "{Attachment} != {User}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "attachment",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'autoNumber' '!=' 'autoNumber' 1`] = `
{
  "formula": "{AutoNumber} != {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "leftType": "autoNumber",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."AutoNumber")::text, '') <> COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'button' '!=' 'button' 1`] = `
{
  "formula": "{Button} != {Button}",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "button",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "button",
  "sql": "(COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '') <> COALESCE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'checkbox' '!=' 'attachment' 1`] = `
{
  "formula": "{Checkbox} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "attachment",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'checkbox' '!=' 'checkbox' 1`] = `
{
  "formula": "{Checkbox} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "leftType": "checkbox",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "checkbox",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <> COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'checkbox' '!=' 'date' 1`] = `
{
  "formula": "{Checkbox} != {Date}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "checkbox",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT ("t"."Checkbox")::text AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(("t"."Checkbox")::text, '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'checkbox' '!=' 'link' 1`] = `
{
  "formula": "{Checkbox} != {LinkType}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "checkbox",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'checkbox' '!=' 'user' 1`] = `
{
  "formula": "{Checkbox} != {User}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "checkbox",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE(("t"."Checkbox")::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'conditionalLookup' '!=' 'conditionalLookup' 1`] = `
{
  "formula": "{ConditionalLookupType} != {ConditionalLookupType}",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "leftType": "conditionalLookup",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "conditionalLookup",
  "sql": "(COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') <> COALESCE((SELECT CASE
          WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
          ELSE lkp.elem #>> '{}'
        END
        FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'conditionalRollup' '!=' 'conditionalRollup' 1`] = `
{
  "formula": "{ConditionalRollupType} != {ConditionalRollupType}",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "conditionalRollup",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "conditionalRollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v) OR (("t"."ConditionalRollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."ConditionalRollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."ConditionalRollupType")::text, '') <> COALESCE(("t"."ConditionalRollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'createdBy' '!=' 'createdBy' 1`] = `
{
  "formula": "{CreatedBy} != {CreatedBy}",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "createdBy",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "createdBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '') <> COALESCE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'createdTime' '!=' 'createdTime' 1`] = `
{
  "formula": "{CreatedTime} != {CreatedTime}",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "createdTime",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "createdTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <> COALESCE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'date' '!=' 'date' 1`] = `
{
  "formula": "{Date} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "leftType": "date",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'date' '!=' 'link' 1`] = `
{
  "formula": "{Date} != {LinkType}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "date",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'date' '!=' 'user' 1`] = `
{
  "formula": "{Date} != {User}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "date",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'attachment' 1`] = `
{
  "formula": "{FormulaType} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'checkbox' 1`] = `
{
  "formula": "{FormulaType} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "((10)::double precision <> (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'date' 1`] = `
{
  "formula": "{FormulaType} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'formula' 1`] = `
{
  "formula": "{FormulaType} != {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'link' 1`] = `
{
  "formula": "{FormulaType} != {LinkType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'multipleSelect' 1`] = `
{
  "formula": "{FormulaType} != {MultipleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'singleSelect' 1`] = `
{
  "formula": "{FormulaType} != {SingleSelect}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'formula' '!=' 'user' 1`] = `
{
  "formula": "{FormulaType} != {User}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "formula",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE((10)::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'lastModifiedBy' '!=' 'lastModifiedBy' 1`] = `
{
  "formula": "{LastModifiedBy} != {LastModifiedBy}",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "leftType": "lastModifiedBy",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "lastModifiedBy",
  "sql": "(COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '') <> COALESCE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'lastModifiedTime' '!=' 'lastModifiedTime' 1`] = `
{
  "formula": "{LastModifiedTime} != {LastModifiedTime}",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "leftType": "lastModifiedTime",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "lastModifiedTime",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '') <> COALESCE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'link' '!=' 'link' 1`] = `
{
  "formula": "{LinkType} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "leftType": "link",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'longText' '!=' 'longText' 1`] = `
{
  "formula": "{LongText} != {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "longText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "longText",
  "sql": "(COALESCE("t"."LongText", '') <> COALESCE("t"."LongText", ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'lookup' '!=' 'lookup' 1`] = `
{
  "formula": "{LookupType} != {LookupType}",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "leftType": "lookup",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "lookup",
  "sql": "(COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), '') <> COALESCE((SELECT CASE
        WHEN lkp.elem IS NULL OR jsonb_typeof(lkp.elem) = 'null' THEN NULL
        ELSE lkp.elem #>> '{}'
      END
      FROM (SELECT ((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp) -> 0) AS elem) AS lkp), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'attachment' 1`] = `
{
  "formula": "{MultipleSelect} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'checkbox' 1`] = `
{
  "formula": "{MultipleSelect} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'date' 1`] = `
{
  "formula": "{MultipleSelect} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'link' 1`] = `
{
  "formula": "{MultipleSelect} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'multipleSelect' 1`] = `
{
  "formula": "{MultipleSelect} != {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'multipleSelect' '!=' 'user' 1`] = `
{
  "formula": "{MultipleSelect} != {User}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "multipleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'attachment' 1`] = `
{
  "formula": "{Number} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'autoNumber' 1`] = `
{
  "formula": "{Number} != {AutoNumber}",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "autoNumber",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v) OR (("t"."AutoNumber")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."AutoNumber")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE(("t"."AutoNumber")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'checkbox' 1`] = `
{
  "formula": "{Number} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(("t"."Number")::double precision <> (CASE WHEN "t"."Checkbox" IS NULL THEN NULL WHEN "t"."Checkbox" THEN 1 ELSE 0 END)::double precision)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'date' 1`] = `
{
  "formula": "{Number} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Date")::text AS val) AS v) OR (("t"."Date")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Date")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE(("t"."Date")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'formula' 1`] = `
{
  "formula": "{Number} != {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'link' 1`] = `
{
  "formula": "{Number} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v) OR (COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'longText' 1`] = `
{
  "formula": "{Number} != {LongText}",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "longText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."LongText" AS val) AS v) OR ("t"."LongText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."LongText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE("t"."LongText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'multipleSelect' 1`] = `
{
  "formula": "{Number} != {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'number' 1`] = `
{
  "formula": "{Number} != {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'rating' 1`] = `
{
  "formula": "{Number} != {Rating}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'singleLineText' 1`] = `
{
  "formula": "{Number} != {SingleLineText}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE("t"."SingleLineText", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'singleSelect' 1`] = `
{
  "formula": "{Number} != {SingleSelect}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleSelect" AS val) AS v) OR ("t"."SingleSelect" IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE("t"."SingleSelect", ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'number' '!=' 'user' 1`] = `
{
  "formula": "{Number} != {User}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "number",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v) OR ((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe) AS val) AS v), 0))
      ELSE (COALESCE(("t"."Number")::text, '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'rating' '!=' 'rating' 1`] = `
{
  "formula": "{Rating} != {Rating}",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "leftType": "rating",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "rating",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Rating")::text AS val) AS v) OR (("t"."Rating")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Rating")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."Rating")::text, '') <> COALESCE(("t"."Rating")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'rollup' '!=' 'rollup' 1`] = `
{
  "formula": "{RollupType} != {RollupType}",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "leftType": "rollup",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "rollup",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."RollupType")::text AS val) AS v) OR (("t"."RollupType")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."RollupType")::text AS val) AS v), 0))
      ELSE (COALESCE(("t"."RollupType")::text, '') <> COALESCE(("t"."RollupType")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'attachment' 1`] = `
{
  "formula": "{SingleLineText} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'checkbox' 1`] = `
{
  "formula": "{SingleLineText} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'date' 1`] = `
{
  "formula": "{SingleLineText} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleLineText" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleLineText", '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'formula' 1`] = `
{
  "formula": "{SingleLineText} != {FormulaType}",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "formula",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT (10)::text AS val) AS v) OR ((10)::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT (10)::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') <> COALESCE((10)::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'link' 1`] = `
{
  "formula": "{SingleLineText} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleLineText} != {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'number' 1`] = `
{
  "formula": "{SingleLineText} != {Number}",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "number",
  "sql": "(CASE
      WHEN ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT "t"."SingleLineText" AS val) AS v) OR ("t"."SingleLineText" IS NULL)) AND ((SELECT (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) FROM (SELECT ("t"."Number")::text AS val) AS v) OR (("t"."Number")::text IS NULL)) THEN (COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT "t"."SingleLineText" AS val) AS v), 0) <> COALESCE((SELECT (CASE
        WHEN NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NULL THEN NULL
        WHEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)') IS NOT NULL AND NOT (NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') IS NOT NULL AND NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') ~ '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)[eE][+-]?\\d+') AND __teable_input_is_valid(SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'), 'numeric')) THEN (SUBSTRING(NULLIF(REGEXP_REPLACE(BTRIM((v.val)::text), '[,\\s]', '', 'g'), '') FROM '^([+-]?\\d+\\.?\\d*|[+-]?\\d*\\.\\d+)'))::double precision
        ELSE NULL
      END) FROM (SELECT ("t"."Number")::text AS val) AS v), 0))
      ELSE (COALESCE("t"."SingleLineText", '') <> COALESCE(("t"."Number")::text, ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'singleLineText' 1`] = `
{
  "formula": "{SingleLineText} != {SingleLineText}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleLineText",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE("t"."SingleLineText", ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'singleSelect' 1`] = `
{
  "formula": "{SingleLineText} != {SingleSelect}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleLineText' '!=' 'user' 1`] = `
{
  "formula": "{SingleLineText} != {User}",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleLineText",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleLineText", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'attachment' 1`] = `
{
  "formula": "{SingleSelect} != {Attachment}",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "attachment",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'checkbox' 1`] = `
{
  "formula": "{SingleSelect} != {Checkbox}",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "checkbox",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE(("t"."Checkbox")::text, ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'date' 1`] = `
{
  "formula": "{SingleSelect} != {Date}",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "date",
  "sql": "(CASE
      WHEN ((SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT "t"."SingleSelect" AS val) AS v) AND (SELECT (__teable_input_is_valid((v.val)::text, 'timestamptz') OR __teable_input_is_valid((v.val)::text, 'timestamp')) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v)) THEN ((SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT "t"."SingleSelect" AS val) AS v) <> (SELECT (CASE
        WHEN __teable_input_is_valid((v.val)::text, 'timestamptz') THEN ((v.val)::text)::timestamptz
        WHEN __teable_input_is_valid((v.val)::text, 'timestamp') THEN ((v.val)::text)::timestamp AT TIME ZONE 'UTC'
        ELSE NULL
      END) FROM (SELECT TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') AS val) AS v))
      ELSE (COALESCE("t"."SingleSelect", '') <> COALESCE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), ''))
    END)",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'link' 1`] = `
{
  "formula": "{SingleSelect} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "link",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'multipleSelect' 1`] = `
{
  "formula": "{SingleSelect} != {MultipleSelect}",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "multipleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE fe.elem #>> '{}'
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'singleSelect' 1`] = `
{
  "formula": "{SingleSelect} != {SingleSelect}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "singleSelect",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE("t"."SingleSelect", ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'singleSelect' '!=' 'user' 1`] = `
{
  "formula": "{SingleSelect} != {User}",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "singleSelect",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "user",
  "sql": "(COALESCE("t"."SingleSelect", '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'user' '!=' 'link' 1`] = `
{
  "formula": "{User} != {LinkType}",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Neq",
  "operator": "!=",
  "result": "true",
  "rightType": "link",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), ''))",
}
`;

exports[`binary comparison operators > 'Neq' 'user' '!=' 'user' 1`] = `
{
  "formula": "{User} != {User}",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "leftType": "user",
  "opId": "Neq",
  "operator": "!=",
  "result": "false",
  "rightType": "user",
  "sql": "(COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), '') <> COALESCE((SELECT CASE
      WHEN fe.elem IS NULL OR jsonb_typeof(fe.elem) = 'null' THEN NULL
      ELSE COALESCE(fe.elem->>'title', fe.elem->>'name', fe.elem #>> '{}')
    END
    FROM (SELECT (COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb) -> 0) AS elem) AS fe), ''))",
}
`;
