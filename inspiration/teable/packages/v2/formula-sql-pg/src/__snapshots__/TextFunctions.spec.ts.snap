// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`text functions > 'Concatenate' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "CONCATENATE({Attachment}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 20-x",
  "sql": "CONCAT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "CONCATENATE({AutoNumber}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1-x",
  "sql": "CONCAT(("t"."AutoNumber")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "CONCATENATE({Button}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "CONCATENATE({Checkbox}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true-x",
  "sql": "CONCAT(("t"."Checkbox")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "CONCATENATE({ConditionalLookupType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "CONCATENATE({ConditionalRollupType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT(("t"."ConditionalRollupType")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "CONCATENATE({CreatedBy}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System-x",
  "sql": "CONCAT((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "CONCATENATE({CreatedTime}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000-00-00 00:00:00.000+00-x",
  "sql": "CONCAT(("t"."CreatedTime")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "CONCATENATE({Date}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024-02-03 00:00:00+00-x",
  "sql": "CONCAT(("t"."Date")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "CONCATENATE({FormulaType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10-x",
  "sql": "CONCAT((10)::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "CONCATENATE({LastModifiedBy}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System-x",
  "sql": "CONCAT((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "CONCATENATE({LastModifiedTime}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000-00-00 00:00:00.000+00-x",
  "sql": "CONCAT(("t"."LastModifiedTime")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "CONCATENATE({LinkType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10-x",
  "sql": "CONCAT(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "CONCATENATE({LongText}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10-x",
  "sql": "CONCAT("t"."LongText", '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "CONCATENATE({LookupType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "CONCATENATE({MultipleSelect}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 20-x",
  "sql": "CONCAT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "CONCATENATE({Number}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10-x",
  "sql": "CONCAT(("t"."Number")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "CONCATENATE({Rating}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4-x",
  "sql": "CONCAT(("t"."Rating")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "CONCATENATE({RollupType}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT(("t"."RollupType")::text, '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "CONCATENATE({SingleLineText}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10-x",
  "sql": "CONCAT("t"."SingleLineText", '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "CONCATENATE({SingleSelect}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10-x",
  "sql": "CONCAT("t"."SingleSelect", '-x')",
}
`;

exports[`text functions > 'Concatenate' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "CONCATENATE({User}, "-x")",
  "funcId": "Concatenate",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": "-x",
  "sql": "CONCAT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '-x')",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "ENCODE_URL_COMPONENT({Attachment})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10%2C%2020",
  "sql": "(CASE WHEN (
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "ENCODE_URL_COMPONENT({AutoNumber})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "(CASE WHEN ("t"."AutoNumber")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."AutoNumber")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "ENCODE_URL_COMPONENT({Button})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}') IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "ENCODE_URL_COMPONENT({Checkbox})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true",
  "sql": "(CASE WHEN ("t"."Checkbox")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."Checkbox")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "ENCODE_URL_COMPONENT({ConditionalLookupType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN (
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "ENCODE_URL_COMPONENT({ConditionalRollupType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN ("t"."ConditionalRollupType")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."ConditionalRollupType")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "ENCODE_URL_COMPONENT({CreatedBy})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "(CASE WHEN (CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "ENCODE_URL_COMPONENT({CreatedTime})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000-00-00%0000%0A00%0A00%0B00",
  "sql": "(CASE WHEN ("t"."CreatedTime")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."CreatedTime")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "ENCODE_URL_COMPONENT({Date})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024-02-03%2000%3A00%3A00%2B00",
  "sql": "(CASE WHEN ("t"."Date")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."Date")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "ENCODE_URL_COMPONENT({FormulaType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10",
  "sql": "(CASE WHEN (10)::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((10)::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "ENCODE_URL_COMPONENT({LastModifiedBy})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "(CASE WHEN (CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "ENCODE_URL_COMPONENT({LastModifiedTime})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000-00-00%0000%0A00%0A00%0B00",
  "sql": "(CASE WHEN ("t"."LastModifiedTime")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."LastModifiedTime")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "ENCODE_URL_COMPONENT({LinkType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "(CASE WHEN COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "ENCODE_URL_COMPONENT({LongText})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "(CASE WHEN "t"."LongText" IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(("t"."LongText")::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "ENCODE_URL_COMPONENT({LookupType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN (
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "ENCODE_URL_COMPONENT({MultipleSelect})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10%2C%2020",
  "sql": "(CASE WHEN (
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "ENCODE_URL_COMPONENT({Number})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "(CASE WHEN ("t"."Number")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."Number")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "ENCODE_URL_COMPONENT({Rating})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "(CASE WHEN ("t"."Rating")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."Rating")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "ENCODE_URL_COMPONENT({RollupType})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN ("t"."RollupType")::text IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to((("t"."RollupType")::text)::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "ENCODE_URL_COMPONENT({SingleLineText})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "(CASE WHEN "t"."SingleLineText" IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(("t"."SingleLineText")::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "ENCODE_URL_COMPONENT({SingleSelect})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "(CASE WHEN "t"."SingleSelect" IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(("t"."SingleSelect")::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'EncodeUrlComponent' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "ENCODE_URL_COMPONENT({User})",
  "funcId": "EncodeUrlComponent",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(CASE WHEN (
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) IS NULL THEN NULL ELSE COALESCE((SELECT string_agg(
      CASE
        WHEN byte_val BETWEEN 48 AND 57
          OR byte_val BETWEEN 65 AND 90
          OR byte_val BETWEEN 97 AND 122
          OR byte_val IN (45, 95, 46, 33, 126, 42, 39, 40, 41)
        THEN chr(byte_val)
        ELSE '%' || UPPER(LPAD(to_hex(byte_val), 2, '0'))
      END,
      ''
      ORDER BY ord
    )
    FROM (
      SELECT ord, get_byte(src.bytes, ord) AS byte_val
      FROM (SELECT convert_to(((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))::text, 'UTF8') AS bytes) AS src
      CROSS JOIN generate_series(0, octet_length(src.bytes) - 1) AS ord
    ) AS utf8_bytes), '') END)",
}
`;

exports[`text functions > 'Find' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "FIND("1", {Attachment}, 1)",
  "funcId": "Find",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "FIND("1", {AutoNumber}, 1)",
  "funcId": "Find",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING(("t"."AutoNumber")::text FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "FIND("1", {Button}, 1)",
  "funcId": "Find",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}') FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "FIND("1", {Checkbox}, 1)",
  "funcId": "Find",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING(("t"."Checkbox")::text FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "FIND("1", {ConditionalLookupType}, 1)",
  "funcId": "Find",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "FIND("1", {ConditionalRollupType}, 1)",
  "funcId": "Find",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "FIND("1", {CreatedBy}, 1)",
  "funcId": "Find",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "FIND("1", {CreatedTime}, 1)",
  "funcId": "Find",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "FIND("1", {Date}, 1)",
  "funcId": "Find",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "FIND("1", {FormulaType}, 1)",
  "funcId": "Find",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING(trim(to_char((10)::numeric, '999999990D00')) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "FIND("1", {LastModifiedBy}, 1)",
  "funcId": "Find",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "FIND("1", {LastModifiedTime}, 1)",
  "funcId": "Find",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "FIND("1", {LinkType}, 1)",
  "funcId": "Find",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "FIND("1", {LongText}, 1)",
  "funcId": "Find",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING("t"."LongText" FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "FIND("1", {LookupType}, 1)",
  "funcId": "Find",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "FIND("1", {MultipleSelect}, 1)",
  "funcId": "Find",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "FIND("1", {Number}, 1)",
  "funcId": "Find",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING(trim(to_char(("t"."Number")::numeric, '999999990D00')) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "FIND("1", {Rating}, 1)",
  "funcId": "Find",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "0",
  "sql": "POSITION('1' IN SUBSTRING(("t"."Rating")::text FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "FIND("1", {RollupType}, 1)",
  "funcId": "Find",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING(trim(to_char(("t"."RollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "FIND("1", {SingleLineText}, 1)",
  "funcId": "Find",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING("t"."SingleLineText" FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "FIND("1", {SingleSelect}, 1)",
  "funcId": "Find",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN SUBSTRING("t"."SingleSelect" FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Find' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "FIND("1", {User}, 1)",
  "funcId": "Find",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION('1' IN SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer)) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'FindNoStart' uses optional parameter 1`] = `
{
  "formula": "FIND("1", {SingleLineText})",
  "funcId": "FindNoStart",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION('1' IN "t"."SingleLineText")",
}
`;

exports[`text functions > 'Left' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "LEFT({Attachment}, 1)",
  "funcId": "Left",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "1",
  "sql": "LEFT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "LEFT({AutoNumber}, 1)",
  "funcId": "Left",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "LEFT(("t"."AutoNumber")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "LEFT({Button}, 1)",
  "funcId": "Left",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "LEFT({Checkbox}, 1)",
  "funcId": "Left",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "t",
  "sql": "LEFT(("t"."Checkbox")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "LEFT({ConditionalLookupType}, 1)",
  "funcId": "Left",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "LEFT({ConditionalRollupType}, 1)",
  "funcId": "Left",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "LEFT({CreatedBy}, 1)",
  "funcId": "Left",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "S",
  "sql": "LEFT((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "LEFT({CreatedTime}, 1)",
  "funcId": "Left",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "LEFT(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "LEFT({Date}, 1)",
  "funcId": "Left",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2",
  "sql": "LEFT(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "LEFT({FormulaType}, 1)",
  "funcId": "Left",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "1",
  "sql": "LEFT(trim(to_char((10)::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "LEFT({LastModifiedBy}, 1)",
  "funcId": "Left",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "S",
  "sql": "LEFT((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "LEFT({LastModifiedTime}, 1)",
  "funcId": "Left",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "LEFT(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "LEFT({LinkType}, 1)",
  "funcId": "Left",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "1",
  "sql": "LEFT(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "LEFT({LongText}, 1)",
  "funcId": "Left",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "LEFT("t"."LongText", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "LEFT({LookupType}, 1)",
  "funcId": "Left",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "LEFT({MultipleSelect}, 1)",
  "funcId": "Left",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "1",
  "sql": "LEFT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "LEFT({Number}, 1)",
  "funcId": "Left",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "LEFT(trim(to_char(("t"."Number")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "LEFT({Rating}, 1)",
  "funcId": "Left",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "LEFT(("t"."Rating")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "LEFT({RollupType}, 1)",
  "funcId": "Left",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT(trim(to_char(("t"."RollupType")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "LEFT({SingleLineText}, 1)",
  "funcId": "Left",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "LEFT("t"."SingleLineText", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "LEFT({SingleSelect}, 1)",
  "funcId": "Left",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "LEFT("t"."SingleSelect", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Left' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "LEFT({User}, 1)",
  "funcId": "Left",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LEFT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Len' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "LEN({Attachment})",
  "funcId": "Len",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "6",
  "sql": "LENGTH((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Len' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "LEN({AutoNumber})",
  "funcId": "Len",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "LENGTH(("t"."AutoNumber")::text)",
}
`;

exports[`text functions > 'Len' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "LEN({Button})",
  "funcId": "Len",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Len' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "LEN({Checkbox})",
  "funcId": "Len",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "4",
  "sql": "LENGTH(("t"."Checkbox")::text)",
}
`;

exports[`text functions > 'Len' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "LEN({ConditionalLookupType})",
  "funcId": "Len",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ))",
}
`;

exports[`text functions > 'Len' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "LEN({ConditionalRollupType})",
  "funcId": "Len",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Len' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "LEN({CreatedBy})",
  "funcId": "Len",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "6",
  "sql": "LENGTH((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Len' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "LEN({CreatedTime})",
  "funcId": "Len",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "00",
  "sql": "LENGTH(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Len' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "LEN({Date})",
  "funcId": "Len",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "16",
  "sql": "LENGTH(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Len' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "LEN({FormulaType})",
  "funcId": "Len",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "5",
  "sql": "LENGTH(trim(to_char((10)::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Len' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "LEN({LastModifiedBy})",
  "funcId": "Len",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "6",
  "sql": "LENGTH((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Len' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "LEN({LastModifiedTime})",
  "funcId": "Len",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "00",
  "sql": "LENGTH(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Len' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "LEN({LinkType})",
  "funcId": "Len",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "2",
  "sql": "LENGTH(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Len' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "LEN({LongText})",
  "funcId": "Len",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "2",
  "sql": "LENGTH("t"."LongText")",
}
`;

exports[`text functions > 'Len' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "LEN({LookupType})",
  "funcId": "Len",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Len' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "LEN({MultipleSelect})",
  "funcId": "Len",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "6",
  "sql": "LENGTH((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Len' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "LEN({Number})",
  "funcId": "Len",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "5",
  "sql": "LENGTH(trim(to_char(("t"."Number")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Len' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "LEN({Rating})",
  "funcId": "Len",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "1",
  "sql": "LENGTH(("t"."Rating")::text)",
}
`;

exports[`text functions > 'Len' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "LEN({RollupType})",
  "funcId": "Len",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH(trim(to_char(("t"."RollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Len' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "LEN({SingleLineText})",
  "funcId": "Len",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "2",
  "sql": "LENGTH("t"."SingleLineText")",
}
`;

exports[`text functions > 'Len' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "LEN({SingleSelect})",
  "funcId": "Len",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "2",
  "sql": "LENGTH("t"."SingleSelect")",
}
`;

exports[`text functions > 'Len' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "LEN({User})",
  "funcId": "Len",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LENGTH((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Lower' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "LOWER({Attachment})",
  "funcId": "Lower",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 20",
  "sql": "LOWER((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Lower' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "LOWER({AutoNumber})",
  "funcId": "Lower",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "LOWER(("t"."AutoNumber")::text)",
}
`;

exports[`text functions > 'Lower' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "LOWER({Button})",
  "funcId": "Lower",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Lower' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "LOWER({Checkbox})",
  "funcId": "Lower",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true",
  "sql": "LOWER(("t"."Checkbox")::text)",
}
`;

exports[`text functions > 'Lower' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "LOWER({ConditionalLookupType})",
  "funcId": "Lower",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ))",
}
`;

exports[`text functions > 'Lower' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "LOWER({ConditionalRollupType})",
  "funcId": "Lower",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Lower' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "LOWER({CreatedBy})",
  "funcId": "Lower",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "system",
  "sql": "LOWER((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Lower' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "LOWER({CreatedTime})",
  "funcId": "Lower",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "LOWER(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Lower' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "LOWER({Date})",
  "funcId": "Lower",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:00",
  "sql": "LOWER(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Lower' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "LOWER({FormulaType})",
  "funcId": "Lower",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10.00",
  "sql": "LOWER(trim(to_char((10)::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Lower' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "LOWER({LastModifiedBy})",
  "funcId": "Lower",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "system",
  "sql": "LOWER((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Lower' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "LOWER({LastModifiedTime})",
  "funcId": "Lower",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "LOWER(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Lower' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "LOWER({LinkType})",
  "funcId": "Lower",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "LOWER(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Lower' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "LOWER({LongText})",
  "funcId": "Lower",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "LOWER("t"."LongText")",
}
`;

exports[`text functions > 'Lower' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "LOWER({LookupType})",
  "funcId": "Lower",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Lower' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "LOWER({MultipleSelect})",
  "funcId": "Lower",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 20",
  "sql": "LOWER((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Lower' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "LOWER({Number})",
  "funcId": "Lower",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10.00",
  "sql": "LOWER(trim(to_char(("t"."Number")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Lower' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "LOWER({Rating})",
  "funcId": "Lower",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "LOWER(("t"."Rating")::text)",
}
`;

exports[`text functions > 'Lower' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "LOWER({RollupType})",
  "funcId": "Lower",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER(trim(to_char(("t"."RollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Lower' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "LOWER({SingleLineText})",
  "funcId": "Lower",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "LOWER("t"."SingleLineText")",
}
`;

exports[`text functions > 'Lower' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "LOWER({SingleSelect})",
  "funcId": "Lower",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "LOWER("t"."SingleSelect")",
}
`;

exports[`text functions > 'Lower' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "LOWER({User})",
  "funcId": "Lower",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "LOWER((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Mid' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "MID({Attachment}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10",
  "sql": "SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "MID({AutoNumber}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "SUBSTRING(("t"."AutoNumber")::text FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "MID({Button}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}') FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "MID({Checkbox}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "tr",
  "sql": "SUBSTRING(("t"."Checkbox")::text FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "MID({ConditionalLookupType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "MID({ConditionalRollupType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "MID({CreatedBy}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "Sy",
  "sql": "SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "MID({CreatedTime}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "00",
  "sql": "SUBSTRING(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "MID({Date}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "20",
  "sql": "SUBSTRING(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "MID({FormulaType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10",
  "sql": "SUBSTRING(trim(to_char((10)::numeric, '999999990D00')) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "MID({LastModifiedBy}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "Sy",
  "sql": "SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "MID({LastModifiedTime}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "00",
  "sql": "SUBSTRING(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "MID({LinkType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "SUBSTRING(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "MID({LongText}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "SUBSTRING("t"."LongText" FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "MID({LookupType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "MID({MultipleSelect}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10",
  "sql": "SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "MID({Number}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "SUBSTRING(trim(to_char(("t"."Number")::numeric, '999999990D00')) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "MID({Rating}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "SUBSTRING(("t"."Rating")::text FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "MID({RollupType}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING(trim(to_char(("t"."RollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "MID({SingleLineText}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "SUBSTRING("t"."SingleLineText" FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "MID({SingleSelect}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "SUBSTRING("t"."SingleSelect" FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'Mid' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "MID({User}, 1, 2)",
  "funcId": "Mid",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer FOR (2)::double precision::integer)",
}
`;

exports[`text functions > 'RegExpReplace' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "REGEXP_REPLACE({Attachment}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "x0, 20",
  "sql": "REGEXP_REPLACE((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "REGEXP_REPLACE({AutoNumber}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "x",
  "sql": "REGEXP_REPLACE(("t"."AutoNumber")::text, '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "REGEXP_REPLACE({Button}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "REGEXP_REPLACE({Checkbox}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true",
  "sql": "REGEXP_REPLACE(("t"."Checkbox")::text, '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "REGEXP_REPLACE({ConditionalLookupType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "REGEXP_REPLACE({ConditionalRollupType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "REGEXP_REPLACE({CreatedBy}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "REGEXP_REPLACE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "REGEXP_REPLACE({CreatedTime}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/0x/00 00:00",
  "sql": "REGEXP_REPLACE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "REGEXP_REPLACE({Date}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:00",
  "sql": "REGEXP_REPLACE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "REGEXP_REPLACE({FormulaType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "x0.00",
  "sql": "REGEXP_REPLACE(trim(to_char((10)::numeric, '999999990D00')), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "REGEXP_REPLACE({LastModifiedBy}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "REGEXP_REPLACE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "REGEXP_REPLACE({LastModifiedTime}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/0x/00 00:00",
  "sql": "REGEXP_REPLACE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "REGEXP_REPLACE({LinkType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "x0",
  "sql": "REGEXP_REPLACE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "REGEXP_REPLACE({LongText}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REGEXP_REPLACE("t"."LongText", '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "REGEXP_REPLACE({LookupType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "REGEXP_REPLACE({MultipleSelect}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "x0, 20",
  "sql": "REGEXP_REPLACE((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "REGEXP_REPLACE({Number}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "x0.00",
  "sql": "REGEXP_REPLACE(trim(to_char(("t"."Number")::numeric, '999999990D00')), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "REGEXP_REPLACE({Rating}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "REGEXP_REPLACE(("t"."Rating")::text, '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "REGEXP_REPLACE({RollupType}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE(trim(to_char(("t"."RollupType")::numeric, '999999990D00')), '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "REGEXP_REPLACE({SingleLineText}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REGEXP_REPLACE("t"."SingleLineText", '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "REGEXP_REPLACE({SingleSelect}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REGEXP_REPLACE("t"."SingleSelect", '1', 'x', 'g')",
}
`;

exports[`text functions > 'RegExpReplace' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "REGEXP_REPLACE({User}, "1", "x")",
  "funcId": "RegExpReplace",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REGEXP_REPLACE((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x', 'g')",
}
`;

exports[`text functions > 'Replace' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "REPLACE({Attachment}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "x0, 20",
  "sql": "OVERLAY((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "REPLACE({AutoNumber}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "x",
  "sql": "OVERLAY(("t"."AutoNumber")::text PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "REPLACE({Button}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}') PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "REPLACE({Checkbox}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "xrue",
  "sql": "OVERLAY(("t"."Checkbox")::text PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "REPLACE({ConditionalLookupType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "REPLACE({ConditionalRollupType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "REPLACE({CreatedBy}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "xystem",
  "sql": "OVERLAY((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "REPLACE({CreatedTime}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "x000/00/00 00:00",
  "sql": "OVERLAY(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "REPLACE({Date}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "x024/02/03 00:00",
  "sql": "OVERLAY(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "REPLACE({FormulaType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "x0.00",
  "sql": "OVERLAY(trim(to_char((10)::numeric, '999999990D00')) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "REPLACE({LastModifiedBy}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "xystem",
  "sql": "OVERLAY((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "REPLACE({LastModifiedTime}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "x000/00/00 00:00",
  "sql": "OVERLAY(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "REPLACE({LinkType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "x0",
  "sql": "OVERLAY(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "REPLACE({LongText}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "OVERLAY("t"."LongText" PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "REPLACE({LookupType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "REPLACE({MultipleSelect}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "x0, 20",
  "sql": "OVERLAY((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "REPLACE({Number}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "x0.00",
  "sql": "OVERLAY(trim(to_char(("t"."Number")::numeric, '999999990D00')) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "REPLACE({Rating}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "x",
  "sql": "OVERLAY(("t"."Rating")::text PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "REPLACE({RollupType}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY(trim(to_char(("t"."RollupType")::numeric, '999999990D00')) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "REPLACE({SingleLineText}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "OVERLAY("t"."SingleLineText" PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "REPLACE({SingleSelect}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "OVERLAY("t"."SingleSelect" PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Replace' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "REPLACE({User}, 1, 1, "x")",
  "funcId": "Replace",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "OVERLAY((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) PLACING 'x' FROM (1)::double precision::integer FOR (1)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "REPT({Attachment}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 2010, 20",
  "sql": "REPEAT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "REPT({AutoNumber}, 2)",
  "funcId": "Rept",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "11",
  "sql": "REPEAT(("t"."AutoNumber")::text, (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "REPT({Button}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "REPT({Checkbox}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "truetrue",
  "sql": "REPEAT(("t"."Checkbox")::text, (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "REPT({ConditionalLookupType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "REPT({ConditionalRollupType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "REPT({CreatedBy}, 2)",
  "funcId": "Rept",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "SystemSystem",
  "sql": "REPEAT((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "REPT({CreatedTime}, 2)",
  "funcId": "Rept",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:000000/00/00 00:00",
  "sql": "REPEAT(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "REPT({Date}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:002024/02/03 00:00",
  "sql": "REPEAT(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "REPT({FormulaType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10.0010.00",
  "sql": "REPEAT(trim(to_char((10)::numeric, '999999990D00')), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "REPT({LastModifiedBy}, 2)",
  "funcId": "Rept",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "SystemSystem",
  "sql": "REPEAT((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "REPT({LastModifiedTime}, 2)",
  "funcId": "Rept",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:000000/00/00 00:00",
  "sql": "REPEAT(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "REPT({LinkType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "1010",
  "sql": "REPEAT(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "REPT({LongText}, 2)",
  "funcId": "Rept",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1010",
  "sql": "REPEAT("t"."LongText", (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "REPT({LookupType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "REPT({MultipleSelect}, 2)",
  "funcId": "Rept",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 2010, 20",
  "sql": "REPEAT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "REPT({Number}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10.0010.00",
  "sql": "REPEAT(trim(to_char(("t"."Number")::numeric, '999999990D00')), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "REPT({Rating}, 2)",
  "funcId": "Rept",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "44",
  "sql": "REPEAT(("t"."Rating")::text, (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "REPT({RollupType}, 2)",
  "funcId": "Rept",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT(trim(to_char(("t"."RollupType")::numeric, '999999990D00')), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "REPT({SingleLineText}, 2)",
  "funcId": "Rept",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1010",
  "sql": "REPEAT("t"."SingleLineText", (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "REPT({SingleSelect}, 2)",
  "funcId": "Rept",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1010",
  "sql": "REPEAT("t"."SingleSelect", (2)::double precision::integer)",
}
`;

exports[`text functions > 'Rept' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "REPT({User}, 2)",
  "funcId": "Rept",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPEAT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (2)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "RIGHT({Attachment}, 1)",
  "funcId": "Right",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "0",
  "sql": "RIGHT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "RIGHT({AutoNumber}, 1)",
  "funcId": "Right",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "RIGHT(("t"."AutoNumber")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "RIGHT({Button}, 1)",
  "funcId": "Right",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "RIGHT({Checkbox}, 1)",
  "funcId": "Right",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "e",
  "sql": "RIGHT(("t"."Checkbox")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "RIGHT({ConditionalLookupType}, 1)",
  "funcId": "Right",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "RIGHT({ConditionalRollupType}, 1)",
  "funcId": "Right",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "RIGHT({CreatedBy}, 1)",
  "funcId": "Right",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "m",
  "sql": "RIGHT((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "RIGHT({CreatedTime}, 1)",
  "funcId": "Right",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "RIGHT(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "RIGHT({Date}, 1)",
  "funcId": "Right",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "0",
  "sql": "RIGHT(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "RIGHT({FormulaType}, 1)",
  "funcId": "Right",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "0",
  "sql": "RIGHT(trim(to_char((10)::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "RIGHT({LastModifiedBy}, 1)",
  "funcId": "Right",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "m",
  "sql": "RIGHT((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "RIGHT({LastModifiedTime}, 1)",
  "funcId": "Right",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "RIGHT(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "RIGHT({LinkType}, 1)",
  "funcId": "Right",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "0",
  "sql": "RIGHT(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "RIGHT({LongText}, 1)",
  "funcId": "Right",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "0",
  "sql": "RIGHT("t"."LongText", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "RIGHT({LookupType}, 1)",
  "funcId": "Right",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "RIGHT({MultipleSelect}, 1)",
  "funcId": "Right",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "0",
  "sql": "RIGHT((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "RIGHT({Number}, 1)",
  "funcId": "Right",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "0",
  "sql": "RIGHT(trim(to_char(("t"."Number")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "RIGHT({Rating}, 1)",
  "funcId": "Right",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "RIGHT(("t"."Rating")::text, (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "RIGHT({RollupType}, 1)",
  "funcId": "Right",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT(trim(to_char(("t"."RollupType")::numeric, '999999990D00')), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "RIGHT({SingleLineText}, 1)",
  "funcId": "Right",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "0",
  "sql": "RIGHT("t"."SingleLineText", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "RIGHT({SingleSelect}, 1)",
  "funcId": "Right",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "0",
  "sql": "RIGHT("t"."SingleSelect", (1)::double precision::integer)",
}
`;

exports[`text functions > 'Right' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "RIGHT({User}, 1)",
  "funcId": "Right",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "RIGHT((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), (1)::double precision::integer)",
}
`;

exports[`text functions > 'Search' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "SEARCH("1", {Attachment}, 1)",
  "funcId": "Search",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "SEARCH("1", {AutoNumber}, 1)",
  "funcId": "Search",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(("t"."AutoNumber")::text FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "SEARCH("1", {Button}, 1)",
  "funcId": "Search",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}') FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "SEARCH("1", {Checkbox}, 1)",
  "funcId": "Search",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(("t"."Checkbox")::text FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "SEARCH("1", {ConditionalLookupType}, 1)",
  "funcId": "Search",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "SEARCH("1", {ConditionalRollupType}, 1)",
  "funcId": "Search",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "SEARCH("1", {CreatedBy}, 1)",
  "funcId": "Search",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "SEARCH("1", {CreatedTime}, 1)",
  "funcId": "Search",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "SEARCH("1", {Date}, 1)",
  "funcId": "Search",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "SEARCH("1", {FormulaType}, 1)",
  "funcId": "Search",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(trim(to_char((10)::numeric, '999999990D00')) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "SEARCH("1", {LastModifiedBy}, 1)",
  "funcId": "Search",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "SEARCH("1", {LastModifiedTime}, 1)",
  "funcId": "Search",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI') FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "SEARCH("1", {LinkType}, 1)",
  "funcId": "Search",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}') FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "SEARCH("1", {LongText}, 1)",
  "funcId": "Search",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING("t"."LongText" FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "SEARCH("1", {LookupType}, 1)",
  "funcId": "Search",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "SEARCH("1", {MultipleSelect}, 1)",
  "funcId": "Search",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "SEARCH("1", {Number}, 1)",
  "funcId": "Search",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(trim(to_char(("t"."Number")::numeric, '999999990D00')) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "SEARCH("1", {Rating}, 1)",
  "funcId": "Search",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "0",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(("t"."Rating")::text FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "SEARCH("1", {RollupType}, 1)",
  "funcId": "Search",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING(trim(to_char(("t"."RollupType")::numeric, '999999990D00')) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "SEARCH("1", {SingleLineText}, 1)",
  "funcId": "Search",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING("t"."SingleLineText" FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "SEARCH("1", {SingleSelect}, 1)",
  "funcId": "Search",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING("t"."SingleSelect" FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'Search' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "SEARCH("1", {User}, 1)",
  "funcId": "Search",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "POSITION(UPPER('1') IN UPPER(SUBSTRING((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ) FROM (1)::double precision::integer))) + (1)::double precision::integer - 1",
}
`;

exports[`text functions > 'SearchNoStart' uses optional parameter 1`] = `
{
  "formula": "SEARCH("1", {SingleLineText})",
  "funcId": "SearchNoStart",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "1",
  "sql": "POSITION(UPPER('1') IN UPPER("t"."SingleLineText"))",
}
`;

exports[`text functions > 'Substitute' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "SUBSTITUTE({Attachment}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "x0, 20",
  "sql": "REPLACE((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "SUBSTITUTE({AutoNumber}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "x",
  "sql": "REPLACE(("t"."AutoNumber")::text, '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "SUBSTITUTE({Button}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "SUBSTITUTE({Checkbox}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true",
  "sql": "REPLACE(("t"."Checkbox")::text, '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "SUBSTITUTE({ConditionalLookupType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "SUBSTITUTE({ConditionalRollupType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "SUBSTITUTE({CreatedBy}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "REPLACE((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "SUBSTITUTE({CreatedTime}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/0x/00 00:00",
  "sql": "REPLACE(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "SUBSTITUTE({Date}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:00",
  "sql": "REPLACE(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "SUBSTITUTE({FormulaType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "x0.00",
  "sql": "REPLACE(trim(to_char((10)::numeric, '999999990D00')), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "SUBSTITUTE({LastModifiedBy}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "REPLACE((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "SUBSTITUTE({LastModifiedTime}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/0x/00 00:00",
  "sql": "REPLACE(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "SUBSTITUTE({LinkType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "x0",
  "sql": "REPLACE(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "SUBSTITUTE({LongText}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REPLACE("t"."LongText", '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "SUBSTITUTE({LookupType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "SUBSTITUTE({MultipleSelect}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "x0, 20",
  "sql": "REPLACE((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "SUBSTITUTE({Number}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "x0.00",
  "sql": "REPLACE(trim(to_char(("t"."Number")::numeric, '999999990D00')), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "SUBSTITUTE({Rating}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "REPLACE(("t"."Rating")::text, '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "SUBSTITUTE({RollupType}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE(trim(to_char(("t"."RollupType")::numeric, '999999990D00')), '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "SUBSTITUTE({SingleLineText}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REPLACE("t"."SingleLineText", '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "SUBSTITUTE({SingleSelect}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "x0",
  "sql": "REPLACE("t"."SingleSelect", '1', 'x')",
}
`;

exports[`text functions > 'Substitute' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "SUBSTITUTE({User}, "1", "x")",
  "funcId": "Substitute",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "REPLACE((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ), '1', 'x')",
}
`;

exports[`text functions > 'T' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "T({Attachment})",
  "funcId": "T",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 20",
  "sql": "(
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    )",
}
`;

exports[`text functions > 'T' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "T({AutoNumber})",
  "funcId": "T",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "T({Button})",
  "funcId": "T",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}')",
}
`;

exports[`text functions > 'T' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "T({Checkbox})",
  "funcId": "T",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "T({ConditionalLookupType})",
  "funcId": "T",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  )",
}
`;

exports[`text functions > 'T' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "T({ConditionalRollupType})",
  "funcId": "T",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "T({CreatedBy})",
  "funcId": "T",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
  "sql": ""t"."CreatedBy"",
}
`;

exports[`text functions > 'T' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "T({CreatedTime})",
  "funcId": "T",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "T({Date})",
  "funcId": "T",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "T({FormulaType})",
  "funcId": "T",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "T({LastModifiedBy})",
  "funcId": "T",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
  "sql": ""t"."LastModifiedBy"",
}
`;

exports[`text functions > 'T' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "T({LastModifiedTime})",
  "funcId": "T",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "T({LinkType})",
  "funcId": "T",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}')",
}
`;

exports[`text functions > 'T' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "T({LongText})",
  "funcId": "T",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": ""t"."LongText"",
}
`;

exports[`text functions > 'T' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "T({LookupType})",
  "funcId": "T",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    )",
}
`;

exports[`text functions > 'T' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "T({MultipleSelect})",
  "funcId": "T",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 20",
  "sql": "(
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    )",
}
`;

exports[`text functions > 'T' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "T({Number})",
  "funcId": "T",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "T({Rating})",
  "funcId": "T",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "T({RollupType})",
  "funcId": "T",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "NULL",
}
`;

exports[`text functions > 'T' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "T({SingleLineText})",
  "funcId": "T",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": ""t"."SingleLineText"",
}
`;

exports[`text functions > 'T' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "T({SingleSelect})",
  "funcId": "T",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": ""t"."SingleSelect"",
}
`;

exports[`text functions > 'T' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "T({User})",
  "funcId": "T",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "(
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    )",
}
`;

exports[`text functions > 'Trim' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "TRIM({Attachment})",
  "funcId": "Trim",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 20",
  "sql": "TRIM((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Trim' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "TRIM({AutoNumber})",
  "funcId": "Trim",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "TRIM(("t"."AutoNumber")::text)",
}
`;

exports[`text functions > 'Trim' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "TRIM({Button})",
  "funcId": "Trim",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Trim' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "TRIM({Checkbox})",
  "funcId": "Trim",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "true",
  "sql": "TRIM(("t"."Checkbox")::text)",
}
`;

exports[`text functions > 'Trim' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "TRIM({ConditionalLookupType})",
  "funcId": "Trim",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ))",
}
`;

exports[`text functions > 'Trim' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "TRIM({ConditionalRollupType})",
  "funcId": "Trim",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Trim' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "TRIM({CreatedBy})",
  "funcId": "Trim",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "TRIM((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Trim' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "TRIM({CreatedTime})",
  "funcId": "Trim",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "TRIM(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Trim' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "TRIM({Date})",
  "funcId": "Trim",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:00",
  "sql": "TRIM(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Trim' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "TRIM({FormulaType})",
  "funcId": "Trim",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10.00",
  "sql": "TRIM(trim(to_char((10)::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Trim' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "TRIM({LastModifiedBy})",
  "funcId": "Trim",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "System",
  "sql": "TRIM((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Trim' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "TRIM({LastModifiedTime})",
  "funcId": "Trim",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "TRIM(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Trim' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "TRIM({LinkType})",
  "funcId": "Trim",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "TRIM(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Trim' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "TRIM({LongText})",
  "funcId": "Trim",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "TRIM("t"."LongText")",
}
`;

exports[`text functions > 'Trim' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "TRIM({LookupType})",
  "funcId": "Trim",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Trim' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "TRIM({MultipleSelect})",
  "funcId": "Trim",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 20",
  "sql": "TRIM((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Trim' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "TRIM({Number})",
  "funcId": "Trim",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10.00",
  "sql": "TRIM(trim(to_char(("t"."Number")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Trim' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "TRIM({Rating})",
  "funcId": "Trim",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "TRIM(("t"."Rating")::text)",
}
`;

exports[`text functions > 'Trim' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "TRIM({RollupType})",
  "funcId": "Trim",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM(trim(to_char(("t"."RollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Trim' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "TRIM({SingleLineText})",
  "funcId": "Trim",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "TRIM("t"."SingleLineText")",
}
`;

exports[`text functions > 'Trim' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "TRIM({SingleSelect})",
  "funcId": "Trim",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "TRIM("t"."SingleSelect")",
}
`;

exports[`text functions > 'Trim' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "TRIM({User})",
  "funcId": "Trim",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "TRIM((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Upper' with 'attachment' 1`] = `
{
  "fieldType": "attachment",
  "formula": "UPPER({Attachment})",
  "funcId": "Upper",
  "inputs": {
    "Attachment": {
      "fieldName": "Attachment",
      "fieldType": "attachment",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "[{"id": "att_1", "name": "10", "path": "/tmp/10", "size": 10, "token": "tok_1", "mimetype": "text/plain"}, {"id": "att_2", "name": "20", "path": "/tmp/20", "size": 20, "token": "tok_2", "mimetype": "text/plain"}]",
    },
  },
  "result": "10, 20",
  "sql": "UPPER((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."Attachment")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Upper' with 'autoNumber' 1`] = `
{
  "fieldType": "autoNumber",
  "formula": "UPPER({AutoNumber})",
  "funcId": "Upper",
  "inputs": {
    "AutoNumber": {
      "fieldName": "AutoNumber",
      "fieldType": "autoNumber",
      "formattedValue": "1",
      "formatting": undefined,
      "rawValue": "1",
    },
  },
  "result": "1",
  "sql": "UPPER(("t"."AutoNumber")::text)",
}
`;

exports[`text functions > 'Upper' with 'button' 1`] = `
{
  "fieldType": "button",
  "formula": "UPPER({Button})",
  "funcId": "Upper",
  "inputs": {
    "Button": {
      "fieldName": "Button",
      "fieldType": "button",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER(COALESCE(("t"."Button")::jsonb->>'title', ("t"."Button")::jsonb->>'name', ("t"."Button")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Upper' with 'checkbox' 1`] = `
{
  "fieldType": "checkbox",
  "formula": "UPPER({Checkbox})",
  "funcId": "Upper",
  "inputs": {
    "Checkbox": {
      "fieldName": "Checkbox",
      "fieldType": "checkbox",
      "formattedValue": "true",
      "formatting": undefined,
      "rawValue": "true",
    },
  },
  "result": "TRUE",
  "sql": "UPPER(("t"."Checkbox")::text)",
}
`;

exports[`text functions > 'Upper' with 'conditionalLookup' 1`] = `
{
  "fieldType": "conditionalLookup",
  "formula": "UPPER({ConditionalLookupType})",
  "funcId": "Upper",
  "inputs": {
    "ConditionalLookupType": {
      "fieldName": "ConditionalLookupType",
      "fieldType": "conditionalLookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": null,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER((
    SELECT string_agg((CASE
    WHEN jsonb_typeof(elem) = 'object' THEN COALESCE(elem->>'title', elem->>'name', elem #>> '{}')
    WHEN jsonb_typeof(elem) = 'array' THEN NULL
    ELSE elem #>> '{}'
  END), ', ' ORDER BY ord)
    FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."ConditionalLookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'jsonb'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) = 'json'::regtype THEN ((("t"."ConditionalLookupType")))::jsonb
    WHEN pg_typeof((("t"."ConditionalLookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."ConditionalLookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."ConditionalLookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."ConditionalLookupType")))::text, 'jsonb') THEN (((("t"."ConditionalLookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."ConditionalLookupType")))
      END
    ELSE to_jsonb((("t"."ConditionalLookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
  ))",
}
`;

exports[`text functions > 'Upper' with 'conditionalRollup' 1`] = `
{
  "fieldType": "conditionalRollup",
  "formula": "UPPER({ConditionalRollupType})",
  "funcId": "Upper",
  "inputs": {
    "ConditionalRollupType": {
      "fieldName": "ConditionalRollupType",
      "fieldType": "conditionalRollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER(trim(to_char(("t"."ConditionalRollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Upper' with 'createdBy' 1`] = `
{
  "fieldType": "createdBy",
  "formula": "UPPER({CreatedBy})",
  "funcId": "Upper",
  "inputs": {
    "CreatedBy": {
      "fieldName": "CreatedBy",
      "fieldType": "createdBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "SYSTEM",
  "sql": "UPPER((CASE
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'object' THEN COALESCE(("t"."CreatedBy")::jsonb->>'title', ("t"."CreatedBy")::jsonb->>'name', ("t"."CreatedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."CreatedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."CreatedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Upper' with 'createdTime' 1`] = `
{
  "fieldType": "createdTime",
  "formula": "UPPER({CreatedTime})",
  "funcId": "Upper",
  "inputs": {
    "CreatedTime": {
      "fieldName": "CreatedTime",
      "fieldType": "createdTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "UPPER(TO_CHAR(("t"."CreatedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Upper' with 'date' 1`] = `
{
  "fieldType": "date",
  "formula": "UPPER({Date})",
  "funcId": "Upper",
  "inputs": {
    "Date": {
      "fieldName": "Date",
      "fieldType": "date",
      "formattedValue": "2024-02-03 00:00:00+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "2024-02-03 00:00:00+00",
    },
  },
  "result": "2024/02/03 00:00",
  "sql": "UPPER(TO_CHAR(("t"."Date")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Upper' with 'formula' 1`] = `
{
  "fieldType": "formula",
  "formula": "UPPER({FormulaType})",
  "funcId": "Upper",
  "inputs": {
    "FormulaType": {
      "fieldName": "FormulaType",
      "fieldType": "formula",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": "10.00",
  "sql": "UPPER(trim(to_char((10)::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Upper' with 'lastModifiedBy' 1`] = `
{
  "fieldType": "lastModifiedBy",
  "formula": "UPPER({LastModifiedBy})",
  "funcId": "Upper",
  "inputs": {
    "LastModifiedBy": {
      "fieldName": "LastModifiedBy",
      "fieldType": "lastModifiedBy",
      "formattedValue": "System",
      "formatting": undefined,
      "rawValue": "{"id": "system", "email": null, "title": "System", "avatarUrl": "/api/attachments/read/public/avatar/system"}",
    },
  },
  "result": "SYSTEM",
  "sql": "UPPER((CASE
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'object' THEN COALESCE(("t"."LastModifiedBy")::jsonb->>'title', ("t"."LastModifiedBy")::jsonb->>'name', ("t"."LastModifiedBy")::jsonb #>> '{}')
    WHEN jsonb_typeof(("t"."LastModifiedBy")::jsonb) = 'array' THEN NULL
    ELSE ("t"."LastModifiedBy")::jsonb #>> '{}'
  END))",
}
`;

exports[`text functions > 'Upper' with 'lastModifiedTime' 1`] = `
{
  "fieldType": "lastModifiedTime",
  "formula": "UPPER({LastModifiedTime})",
  "funcId": "Upper",
  "inputs": {
    "LastModifiedTime": {
      "fieldName": "LastModifiedTime",
      "fieldType": "lastModifiedTime",
      "formattedValue": "0000-00-00 00:00:00.000+00",
      "formatting": {
        "date": "YYYY/MM/DD",
        "time": "HH:mm",
        "timeZone": "Asia/Shanghai",
      },
      "rawValue": "0000-00-00 00:00:00.000+00",
    },
  },
  "result": "0000/00/00 00:00",
  "sql": "UPPER(TO_CHAR(("t"."LastModifiedTime")::timestamptz AT TIME ZONE 'UTC', 'YYYY/MM/DD HH24:MI'))",
}
`;

exports[`text functions > 'Upper' with 'link' 1`] = `
{
  "fieldType": "link",
  "formula": "UPPER({LinkType})",
  "funcId": "Upper",
  "inputs": {
    "LinkType": {
      "fieldName": "LinkType",
      "fieldType": "link",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "{"id": "rec_*", "title": "10"}",
    },
  },
  "result": "10",
  "sql": "UPPER(COALESCE(("t"."LinkType")::jsonb->>'title', ("t"."LinkType")::jsonb->>'name', ("t"."LinkType")::jsonb #>> '{}'))",
}
`;

exports[`text functions > 'Upper' with 'longText' 1`] = `
{
  "fieldType": "longText",
  "formula": "UPPER({LongText})",
  "funcId": "Upper",
  "inputs": {
    "LongText": {
      "fieldName": "LongText",
      "fieldType": "longText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "UPPER("t"."LongText")",
}
`;

exports[`text functions > 'Upper' with 'lookup' 1`] = `
{
  "fieldType": "lookup",
  "formula": "UPPER({LookupType})",
  "funcId": "Upper",
  "inputs": {
    "LookupType": {
      "fieldName": "LookupType",
      "fieldType": "lookup",
      "formattedValue": "",
      "formatting": undefined,
      "innerField": {
        "fieldName": "LookupType",
        "fieldType": "singleLineText",
        "formattedValue": null,
        "formatting": undefined,
        "rawValue": null,
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements((SELECT CASE
        WHEN _lkp.v IS NULL THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'null' THEN '[]'::jsonb
        WHEN jsonb_typeof(_lkp.v) = 'array' THEN _lkp.v
        ELSE jsonb_build_array(_lkp.v)
      END FROM (SELECT (CASE
    WHEN (("t"."LookupType")) IS NULL THEN NULL
    WHEN pg_typeof((("t"."LookupType"))) = 'jsonb'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) = 'json'::regtype THEN ((("t"."LookupType")))::jsonb
    WHEN pg_typeof((("t"."LookupType"))) IN ('text', 'varchar', 'bpchar', 'character varying', 'unknown') THEN
      CASE
        WHEN NULLIF(BTRIM(((("t"."LookupType")))::text), '') IS NULL THEN NULL
        WHEN (LEFT(BTRIM(((("t"."LookupType")))::text), 1) IN ('[', '{')) AND __teable_input_is_valid(((("t"."LookupType")))::text, 'jsonb') THEN (((("t"."LookupType")))::text)::jsonb
        ELSE to_jsonb((("t"."LookupType")))
      END
    ELSE to_jsonb((("t"."LookupType")))
  END) AS v) AS _lkp)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Upper' with 'multipleSelect' 1`] = `
{
  "fieldType": "multipleSelect",
  "formula": "UPPER({MultipleSelect})",
  "funcId": "Upper",
  "inputs": {
    "MultipleSelect": {
      "fieldName": "MultipleSelect",
      "fieldType": "multipleSelect",
      "formattedValue": "10, 20",
      "formatting": undefined,
      "rawValue": "["10", "20"]",
    },
  },
  "result": "10, 20",
  "sql": "UPPER((
      SELECT string_agg(elem #>> '{}', ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."MultipleSelect")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;

exports[`text functions > 'Upper' with 'number' 1`] = `
{
  "fieldType": "number",
  "formula": "UPPER({Number})",
  "funcId": "Upper",
  "inputs": {
    "Number": {
      "fieldName": "Number",
      "fieldType": "number",
      "formattedValue": "10",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": "10",
    },
  },
  "result": "10.00",
  "sql": "UPPER(trim(to_char(("t"."Number")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Upper' with 'rating' 1`] = `
{
  "fieldType": "rating",
  "formula": "UPPER({Rating})",
  "funcId": "Upper",
  "inputs": {
    "Rating": {
      "fieldName": "Rating",
      "fieldType": "rating",
      "formattedValue": "4",
      "formatting": undefined,
      "rawValue": "4",
    },
  },
  "result": "4",
  "sql": "UPPER(("t"."Rating")::text)",
}
`;

exports[`text functions > 'Upper' with 'rollup' 1`] = `
{
  "fieldType": "rollup",
  "formula": "UPPER({RollupType})",
  "funcId": "Upper",
  "inputs": {
    "RollupType": {
      "fieldName": "RollupType",
      "fieldType": "rollup",
      "formattedValue": "",
      "formatting": {
        "precision": 2,
        "type": "decimal",
      },
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER(trim(to_char(("t"."RollupType")::numeric, '999999990D00')))",
}
`;

exports[`text functions > 'Upper' with 'singleLineText' 1`] = `
{
  "fieldType": "singleLineText",
  "formula": "UPPER({SingleLineText})",
  "funcId": "Upper",
  "inputs": {
    "SingleLineText": {
      "fieldName": "SingleLineText",
      "fieldType": "singleLineText",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "UPPER("t"."SingleLineText")",
}
`;

exports[`text functions > 'Upper' with 'singleSelect' 1`] = `
{
  "fieldType": "singleSelect",
  "formula": "UPPER({SingleSelect})",
  "funcId": "Upper",
  "inputs": {
    "SingleSelect": {
      "fieldName": "SingleSelect",
      "fieldType": "singleSelect",
      "formattedValue": "10",
      "formatting": undefined,
      "rawValue": "10",
    },
  },
  "result": "10",
  "sql": "UPPER("t"."SingleSelect")",
}
`;

exports[`text functions > 'Upper' with 'user' 1`] = `
{
  "fieldType": "user",
  "formula": "UPPER({User})",
  "funcId": "Upper",
  "inputs": {
    "User": {
      "fieldName": "User",
      "fieldType": "user",
      "formattedValue": "",
      "formatting": undefined,
      "rawValue": null,
    },
  },
  "result": null,
  "sql": "UPPER((
      SELECT string_agg(COALESCE(elem->>'title', elem->>'name', elem #>> '{}'), ', ' ORDER BY ord)
      FROM jsonb_array_elements(COALESCE(NULLIF(("t"."User")::jsonb, 'null'::jsonb), '[]'::jsonb)) WITH ORDINALITY AS _jae(elem, ord)
    ))",
}
`;
